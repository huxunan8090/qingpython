<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="http://www.qingxzd.com/favicon.ico"
    />
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.5.17
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.indexOf(e) > -1 ? e : r[0]
        );
      })();
    </script>
    <title>数据采集</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/python/p5" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;https://z3.ax1x.com/2021/08/18/fITurD.jpg&#x27;)" href="/">青青社区</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a aria-current="page" class="active" href="/python">Python</a></span><span><a target="_blank" rel="noopener noreferrer" href="http://www.qingxzd.com">青青社区<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="http://classroom.qingxzd.com/">青青小班课<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span>QQ交流群：1000000</span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;https://z3.ax1x.com/2021/08/18/fITurD.jpg&#x27;)" href="/"></a><h1>青青社区</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/python">Python</a></li><li><a target="_blank" rel="noopener noreferrer" href="http://www.qingxzd.com">青青社区<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="http://classroom.qingxzd.com/">青青小班课<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>QQ交流群：1000000</li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/python/p1">初识 python</a></li><li><a href="/python/p2">Python 基础实操题</a></li><li><a href="/python/p3">数据分析的强力工具</a></li><li><a href="/python/p4">python 操作 mysql</a></li><li><a aria-current="page" class="active" href="/python/p5">数据采集</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="1.1 获取网页源代码" data-depth="2"><a href="/python/p5#11-获取网页源代码"><span>1.1 获取网页源代码</span></a></li><li title="1.2 解析网页内容" data-depth="2"><a href="/python/p5#12-解析网页内容"><span>1.2 解析网页内容</span></a></li><li title="1.3 获取数据" data-depth="2"><a href="/python/p5#13-获取数据"><span>1.3 获取数据</span></a></li><li title="1.4 反复横跳爬虫" data-depth="2"><a href="/python/p5#14-反复横跳爬虫"><span>1.4 反复横跳爬虫</span></a></li><li title="2.1 问题" data-depth="2"><a href="/python/p5#21-问题"><span>2.1 问题</span></a></li><li title="2.2 思考" data-depth="2"><a href="/python/p5#22-思考"><span>2.2 思考</span></a></li><li title="3.1 匹配数字" data-depth="2"><a href="/python/p5#31-匹配数字"><span>3.1 匹配数字</span></a></li><li title="3.2 匹配字母" data-depth="2"><a href="/python/p5#32-匹配字母"><span>3.2 匹配字母</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="数据采集"><a aria-hidden="true" tabindex="-1" href="/python/p5#数据采集"><span class="icon icon-link"></span></a>数据采集</h1><h1 id="1-爬虫上"><a aria-hidden="true" tabindex="-1" href="/python/p5#1-爬虫上"><span class="icon icon-link"></span></a>1 爬虫（上）</h1><p>这个文档将带你进入爬虫的大门，爬虫是<strong>快速</strong>获取<strong>大量</strong>互联网信息的常用方法 这里只介绍基础的使用</p><h2 id="11-获取网页源代码"><a aria-hidden="true" tabindex="-1" href="/python/p5#11-获取网页源代码"><span class="icon icon-link"></span></a>1.1 获取网页源代码</h2><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> requests </span><span class="token comment"># request是一个python用于网络访问的包</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">url</span><span class="token operator">=</span><span class="token string">&#x27;https://movie.douban.com/subject/1292052/&#x27;</span><span class="token plain"> </span><span class="token comment">#将我们需要获取信息的网址复制给“url”这个变量</span></div></pre></div><p><strong>url</strong>：统一资源定位符 这里我们直接理解为网址就 OK</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">res</span><span class="token operator">=</span><span class="token plain">requests</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token plain">url</span><span class="token punctuation">)</span><span class="token plain">    </span><span class="token comment"># 使用“get”方法来向服务器访问这个url，除了get还有post、put等方法</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">res</span></div></pre></div><p><font size="5">418 是服务器返回给我们的请求结果的代码，它来自一个<code>超文本茶壶控制协议</code></font></p><p><strong>注意事项：</strong></p><p>在这个协议中幽默的指出了我们的访问已经被是被为爬虫了 我们需要在<font color="red"><strong>请求头（headers）</strong></font>中加入更多的信息来<strong>伪装</strong>自己的身份<font color="red"><strong>请求头（headers）</strong></font>可以理解为我们向服务器发起请求的门票，服务器可以通过请求头来验证我们的身份 一个<strong>请求头</strong>由名称（不区分大小写）后跟一个冒号“：”，冒号后跟具体的值（不带换行符）组成。 例如，我们找一个<font color="red"><strong>浏览器代理(User-Agent)</strong></font>,将它添加到请求头中<a target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers">请求头详情<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">headers</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#x27;User-Agent&#x27;</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Edg/87.0.664.66&#x27;</span><span class="token punctuation">}</span></div></pre></div><p>好了，我们现在在请求头中添加了一个浏览器代理。再来试试访问这个 url 吧</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">res</span><span class="token operator">=</span><span class="token plain">requests</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token plain">url</span><span class="token punctuation">,</span><span class="token plain">headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation">)</span><span class="token plain">    </span><span class="token comment"># 告诉服务器，把我要的东西给我,和第一次不太一样，这次我们加上了浏览器代理。</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">res</span></div></pre></div><p>服务器返回的代码已经变成 200，表示已经成功返回数据 我们将 get 返回的对象赋值给了 res 这个变量</p><ul><li>查看 res 的 content 属性：</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">res</span><span class="token punctuation">.</span><span class="token plain">content</span></div></pre></div><p>**<code>.content</code>**返回二进制数据（数据使用二进制在网络中传输）</p><p>我们一般是看不懂的，需要使用**<code>decode()</code><strong>方法进行</strong>解码**。</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">res_1</span><span class="token operator">=</span><span class="token plain">res</span><span class="token punctuation">.</span><span class="token plain">content</span><span class="token punctuation">.</span><span class="token plain">decode</span><span class="token punctuation">(</span><span class="token string">&#x27;utf8&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment">#指定（默认）使用utf8这种编码方式进行解码</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">res_1</span><span class="token comment"># 这样我们就看到我们熟悉的中文了。</span></div></pre></div><h2 id="12-解析网页内容"><a aria-hidden="true" tabindex="-1" href="/python/p5#12-解析网页内容"><span class="icon icon-link"></span></a>1.2 解析网页内容</h2><p>我们发现，所有的网页的内容，都是放在标签里面的。我们只需要找到相应的标签，就能知道相应的内容。</p><p>例如：</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">&lt;title&gt;肖申克的救赎 (豆瓣)&lt;/title&gt;</span></div></pre></div><p>就是由 title 标签包裹了一串文字 因此，我们需要新的工具来帮助我们进行标签的查找。<strong>Beautifulsoup</strong>就是帮助我们查到标签和标签内内容的工具。</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">from</span><span class="token plain"> bs4 </span><span class="token keyword">import</span><span class="token plain"> BeautifulSoup  </span><span class="token comment"># 从bs4这个大包里，导入Beautifulsoup这个模块</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token operator">=</span><span class="token plain">BeautifulSoup</span><span class="token punctuation">(</span><span class="token plain">res_1</span><span class="token punctuation">,</span><span class="token string">&#x27;html.parser&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment"># 将网页文本传给BeaytifulSoup类，并制定解析器为“html.parser”</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">soup</span></div></pre></div><p><strong>beautifulsoup 基础使用</strong></p><ul><li><strong>find()<strong>方法，可以按照标签名称进行查找 它返回一个满足条件的标签对，并可以进行</strong>链式查询</strong></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;h1&#x27;</span><span class="token punctuation">)</span></div></pre></div><p>在 h1 标签中还有<code>span</code>标签，可以进行<strong>链式调用</strong></p><ol><li><strong>获取 property=&quot;v:itemreviewe“的 span 标签的内容（text）</strong></li></ol><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;h1&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&#x27;property&#x27;</span><span class="token punctuation">:</span><span class="token string">&#x27;v:itemreviewed&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">text</span></div></pre></div><ol start="2"><li><strong>获取 class=&quot;year&quot;的 span 标签的内容（text）</strong></li></ol><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;h1&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">:</span><span class="token string">&#x27;year&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">text</span><span class="token punctuation">.</span><span class="token plain">replace</span><span class="token punctuation">(</span><span class="token string">&#x27;(&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">replace</span><span class="token punctuation">(</span><span class="token string">&#x27;)&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span></div></pre></div><p><strong>find 只会返回找到的第一个标签</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;h1&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">text</span></div></pre></div><p><strong>find_all 会以列表形式返回找到的所有的标签</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;h1&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">find_all</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">)</span></div></pre></div><h2 id="13-获取数据"><a aria-hidden="true" tabindex="-1" href="/python/p5#13-获取数据"><span class="icon icon-link"></span></a>1.3 获取数据</h2><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">url</span><span class="token operator">=</span><span class="token string">&#x27;https://movie.douban.com/subject/1292052/&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">headers</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#x27;User-Agent&#x27;</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Edg/87.0.664.66&#x27;</span><span class="token punctuation">}</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">res</span><span class="token operator">=</span><span class="token plain">requests</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token plain">url</span><span class="token punctuation">,</span><span class="token plain">headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token operator">=</span><span class="token plain">BeautifulSoup</span><span class="token punctuation">(</span><span class="token plain">res</span><span class="token punctuation">.</span><span class="token plain">content</span><span class="token punctuation">.</span><span class="token plain">decode</span><span class="token punctuation">(</span><span class="token string">&#x27;utf8&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#x27;html.parser&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">names</span><span class="token operator">=</span><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">:</span><span class="token string">&#x27;actor&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">:</span><span class="token string">&#x27;attrs&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">find_all</span><span class="token punctuation">(</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">names</span></div></pre></div><ul><li><strong>将信息提取到列表当中</strong></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">name</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">for</span><span class="token plain"> i </span><span class="token keyword">in</span><span class="token plain"> names</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    name</span><span class="token punctuation">.</span><span class="token plain">append</span><span class="token punctuation">(</span><span class="token plain">i</span><span class="token punctuation">.</span><span class="token plain">text</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment">#将names中的标签循环调用text属性存入name列表</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">name</span></div></pre></div><h2 id="14-反复横跳爬虫"><a aria-hidden="true" tabindex="-1" href="/python/p5#14-反复横跳爬虫"><span class="icon icon-link"></span></a>1.4 反复横跳爬虫</h2><p><strong>1.访问主页，获得所有的超链接</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">url</span><span class="token operator">=</span><span class="token string">&#x27;https://movie.douban.com/top250&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">headers</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#x27;User-Agent&#x27;</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Edg/87.0.664.66&#x27;</span><span class="token punctuation">}</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">req</span><span class="token operator">=</span><span class="token plain">requests</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token plain">url</span><span class="token punctuation">,</span><span class="token plain">headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">req</span><span class="token punctuation">.</span><span class="token plain">text </span><span class="token comment"># text 便捷返回对content的解码内容（默认utf8）</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token operator">=</span><span class="token plain">BeautifulSoup</span><span class="token punctuation">(</span><span class="token plain">req</span><span class="token punctuation">.</span><span class="token plain">text</span><span class="token punctuation">,</span><span class="token string">&#x27;html.parser&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">soup</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">li_list</span><span class="token operator">=</span><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;ol&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">find_all</span><span class="token punctuation">(</span><span class="token string">&#x27;li&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment"># 先拿到第一个ol标签再找到里面所有的li标签</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">web</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">for</span><span class="token plain"> i </span><span class="token keyword">in</span><span class="token plain"> li_list</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    web</span><span class="token punctuation">.</span><span class="token plain">append</span><span class="token punctuation">(</span><span class="token plain">i</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token string">&#x27;href&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">web</span></div></pre></div><p><strong>2.循环访问列表中的链接，进一步获取数据</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">bd_list</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">for</span><span class="token plain"> url </span><span class="token keyword">in</span><span class="token plain"> web</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#x27;我在爬一部电影&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    req</span><span class="token operator">=</span><span class="token plain">requests</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token plain">url</span><span class="token punctuation">,</span><span class="token plain">headers</span><span class="token operator">=</span><span class="token plain">header</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    soup</span><span class="token operator">=</span><span class="token plain">BeautifulSoup</span><span class="token punctuation">(</span><span class="token plain">req</span><span class="token punctuation">.</span><span class="token plain">content</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    bd_list</span><span class="token punctuation">.</span><span class="token plain">append</span><span class="token punctuation">(</span><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&#x27;property&#x27;</span><span class="token punctuation">:</span><span class="token string">&#x27;v:itemreviewed&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">text</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#x27;高兴啊，爬完了一部电影&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">bd_list</span></div></pre></div><h1 id="2-爬虫下"><a aria-hidden="true" tabindex="-1" href="/python/p5#2-爬虫下"><span class="icon icon-link"></span></a>2 爬虫（下）</h1><p><strong>这部分将会引入爬虫中常用的正则表达式来解决网页标签不配对的问题</strong></p><h2 id="21-问题"><a aria-hidden="true" tabindex="-1" href="/python/p5#21-问题"><span class="icon icon-link"></span></a>2.1 问题</h2><p>目的：爬取豆瓣 250</p><p>要求：爬取豆瓣 250 里的制片国家/地区，语言，上映时间这些信息</p><p>我们再来复习一下之前的爬虫操作流程：</p><blockquote><ol><li>准备相关的工具，导入相关的模块库</li><li>设置好代理(目前我们只需要用 headers 模拟浏览器）。准备好需要爬的网站的 url。</li><li>使用 BeautifulSoup 获取特定标签下的数据</li></ol></blockquote><p><strong>用我们之前学过的知识，爬取豆瓣 TOP250 的网页内容：</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> requests</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> bs4 </span><span class="token keyword">import</span><span class="token plain"> BeautifulSoup</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">headers</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#x27;User-Agent&#x27;</span><span class="token punctuation">:</span><span class="token string">&#x27;MMozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0&#x27;</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">url</span><span class="token operator">=</span><span class="token string">&#x27;https://movie.douban.com/top250&#x27;</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">res</span><span class="token operator">=</span><span class="token plain">requests</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token plain">url</span><span class="token operator">=</span><span class="token plain">url</span><span class="token punctuation">,</span><span class="token plain">headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation">)</span></div></pre></div><p>还是使用‘uft-8’解码我们获取的 response 里的内容</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span><span class="token operator">=</span><span class="token plain">BeautifulSoup</span><span class="token punctuation">(</span><span class="token plain">res</span><span class="token punctuation">.</span><span class="token plain">content</span><span class="token punctuation">,</span><span class="token string">&#x27;html.parser&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup</span></div></pre></div><p><strong>获取其中一部电影的网址：</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">new_url</span><span class="token operator">=</span><span class="token plain">soup</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;ol&#x27;</span><span class="token punctuation">,</span><span class="token plain">class_</span><span class="token operator">=</span><span class="token string">&#x27;grid_view&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">,</span><span class="token plain">class_</span><span class="token operator">=</span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token string">&#x27;href&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">new_url</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">res1 </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation">.</span><span class="token plain">get</span><span class="token punctuation">(</span><span class="token plain">new_url</span><span class="token punctuation">,</span><span class="token plain">headers</span><span class="token operator">=</span><span class="token plain">headers</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">soup1</span><span class="token operator">=</span><span class="token plain">BeautifulSoup</span><span class="token punctuation">(</span><span class="token plain">res1</span><span class="token punctuation">.</span><span class="token plain">content</span><span class="token punctuation">,</span><span class="token string">&#x27;html.parser&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">soup1</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">s1</span><span class="token operator">=</span><span class="token plain">soup1</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;div&#x27;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">:</span><span class="token string">&#x27;info&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">s1</span></div></pre></div><p><strong>在上一个结果的基础上再进行寻找：</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">s2</span><span class="token operator">=</span><span class="token plain">s1</span><span class="token punctuation">.</span><span class="token plain">find_all</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">:</span><span class="token string">&#x27;pl&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">s2</span></div></pre></div><p>发现直接使用 Beautifulsoup 无法提取出我们需要的信息。</p><h2 id="22-思考"><a aria-hidden="true" tabindex="-1" href="/python/p5#22-思考"><span class="icon icon-link"></span></a>2.2 思考</h2><p>为什么会出现这样的问题？如何去解决？</p><p><strong>解决方法一：尝试把未知的问题转换成已知的问题</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">mystr</span><span class="token operator">=</span><span class="token string">&#x27;&lt;span class=&quot;pl&quot;&gt;制片国家/地区:&lt;/span&gt; 美国&lt;span class=&quot;pl&quot;&gt;语言:&lt;/span&gt;&#x27;</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">s4</span><span class="token operator">=</span><span class="token plain">BeautifulSoup</span><span class="token punctuation">(</span><span class="token plain">mystr</span><span class="token punctuation">,</span><span class="token string">&#x27;html.parser&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">s4</span><span class="token punctuation">.</span><span class="token plain">find</span><span class="token punctuation">(</span><span class="token string">&#x27;span&#x27;</span><span class="token punctuation">,</span><span class="token plain">class_</span><span class="token operator">=</span><span class="token string">&#x27;pl&#x27;</span><span class="token punctuation">)</span></div></pre></div><p><strong>解决方法二：尝试使用新工具</strong></p><p>先来看一个正则表达式的例子</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> re</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">mystr</span><span class="token operator">=</span><span class="token string">&#x27;class=&quot;pl&quot;&gt;制片国家/地区:&lt;/span&gt; 美国&lt;span class=&quot;pl&quot;&gt;语言:&lt;&#x27;</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;&lt;/span&gt; (.*)&lt;span&#x27;</span><span class="token punctuation">,</span><span class="token plain">mystr</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">[&#x27;美国&#x27;]</span></div></pre></div><h1 id="3-正则表达式"><a aria-hidden="true" tabindex="-1" href="/python/p5#3-正则表达式"><span class="icon icon-link"></span></a>3 正则表达式</h1><p><strong>什么是正则表达式？</strong></p><p>正则表达式并非一门专用语言，但也可以看作是一种语言，它可以让用户通过使用一系列普通字符和特殊字符构建能明确描述文本字符串的匹配模式。除了简单描述这些模式之外，正则表达式解释引擎通常可用于遍历匹配，并使用模式作为分隔符来将字符串解析为字符子串。</p><p>要使用正则表达式，首先需要导入 re 模块。 正则表达式有两种基本的文本匹配方法：</p><blockquote><p>1.findall 2.search</p></blockquote><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> re     </span><span class="token comment">#regrex</span></div></pre></div><h2 id="31-匹配数字"><a aria-hidden="true" tabindex="-1" href="/python/p5#31-匹配数字"><span class="icon icon-link"></span></a>3.1 匹配数字</h2><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">#case 1:匹配数字</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;123&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># b=re.findall(r&#x27;你的模式&#x27;，你要查看的字符串)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;[0123456789]&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;@#$FSF123&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;[0-9]&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span></div></pre></div><h2 id="32-匹配字母"><a aria-hidden="true" tabindex="-1" href="/python/p5#32-匹配字母"><span class="icon icon-link"></span></a>3.2 匹配字母</h2><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">#case 2:匹配字母</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;123&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># b=re.findall(r&#x27;你的模式&#x27;，你要查看的字符串)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;[a-z]&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;@#$FSFf123&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;[A-Za-z@]&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#[]的作用，给定一个匹配的对象，[]内的内容就是你要匹配的字串的一个集合</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">def</span><span class="token plain"> </span><span class="token function">m</span><span class="token punctuation">(</span><span class="token plain">pattern</span><span class="token punctuation">,</span><span class="token plain">text</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token plain">pattern</span><span class="token punctuation">,</span><span class="token plain">text</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">m</span><span class="token punctuation">(</span><span class="token string">r&#x27;[A-Za-z#$&amp;]&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;@#$FSF123&#x27;</span><span class="token punctuation">)</span></div></pre></div><p>note：在正则表达式中，有一些快捷方式</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># [0-9]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># [A-Za-z]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># \d 表示的是任意的一个数字(digits)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># \w 表示的是任意一个字母和数字等(word)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># \s 表示的是一些空格，换行符这类的，并且在结果里显示出来</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># \b 表示的是长度为0的字符串，不在结果里显示。可以通俗的理解为，\b放前面，表示要找一个前面没有相邻字符的这么一个字串</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">m</span><span class="token punctuation">(</span><span class="token string">r&#x27;[\d]&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;12345&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">m</span><span class="token punctuation">(</span><span class="token string">r&#x27;[\w]&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;abc123anc&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;1236#@$Sf34&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;[\d]&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;abc123anc$#%#$%&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;[A-Za-z]&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">text</span><span class="token operator">=</span><span class="token string">&#x27;sjfksPython Python I am coming&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">m</span><span class="token punctuation">(</span><span class="token string">r&#x27;\bPython&#x27;</span><span class="token punctuation">,</span><span class="token plain">text</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">search</span><span class="token punctuation">(</span><span class="token string">r&#x27;Python\b&#x27;</span><span class="token punctuation">,</span><span class="token plain">text</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">text</span><span class="token operator">=</span><span class="token string">&#x27;sjfksPython Python I am coming&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">m</span><span class="token punctuation">(</span><span class="token string">r&#x27;Python\b&#x27;</span><span class="token punctuation">,</span><span class="token plain">text</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">text</span><span class="token operator">=</span><span class="token string">&#x27;sjfksPython Python I am coming&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">m</span><span class="token punctuation">(</span><span class="token string">r&#x27;\bPython\b&#x27;</span><span class="token punctuation">,</span><span class="token plain">text</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">def</span><span class="token plain"> </span><span class="token function">t</span><span class="token punctuation">(</span><span class="token plain">text</span><span class="token punctuation">,</span><span class="token plain">pattern</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token plain">pattern</span><span class="token punctuation">,</span><span class="token plain">text</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;masterpython python sdkjflsj pythonsfsf&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;python&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">,</span><span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;-&#x27;</span><span class="token operator">*</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;\spython&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">search</span><span class="token punctuation">(</span><span class="token string">r&#x27;\spython&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">,</span><span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;-&#x27;</span><span class="token operator">*</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;\spython\s&#x27;</span><span class="token punctuation">)</span><span class="token plain">  </span><span class="token comment"># 记得我门之前说过， \s匹配空格，换行等</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;python\s&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;\bpython&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">search</span><span class="token punctuation">(</span><span class="token string">r&#x27;\bpython&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">,</span><span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;-&#x27;</span><span class="token operator">*</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;\bpython\b&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;python\b&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;masterpython python sdkjflsj pythonsfsf&#x27;</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">search</span><span class="token punctuation">(</span><span class="token string">r&#x27;python\b&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">#{} 表示的是一个范围，里面可以是具体的数值，也可表示的是一个闭区间。</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 这种方法总是优先匹配最长的，因为正则匹配使用的是贪心算法 。</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;1234325692312&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\d]{2,3}?&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;1234325693&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\d]{1,4}&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">text</span><span class="token operator">=</span><span class="token string">&#x27;honour3 honor4sfd s f honor5 yy good&#x27;</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">text</span><span class="token punctuation">,</span><span class="token string">r&#x27;(honour)|(honor)&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">text</span><span class="token punctuation">,</span><span class="token string">r&#x27;honou?r[\d]&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">#一种特殊符号 ？ 表示可保留，也可表示不保留。因为正则匹配是贪心的，所以会尽可能保留完整的。</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#1.情况1：处理单个模式的匹配</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;python3 python&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;python3?&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;honour honor&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;honou?r&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#2.情况2：</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;123$%#1233467&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\d]{1,6}&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 表面上，是非贪心算法，从区间的下限这个数量去查找。在实际过程中，永远只能是最短匹配</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># . :可以匹配任何字符</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;$%@#%@%AFDSF!@#!3123fsf___+++&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;.+&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 另外两个特殊字符 * +</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># *表示重复0到n次</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># +表示重复1到n次</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;$%@#%@%AFDSF!@#!3123fsf___+++&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;.*&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;$4%@4.4DFGFDGDFG4+4#%@%4AFD44%$4SF!@#!3123f4sf___+++&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;4.+?4&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 正则匹配是贪心的，总是希望找到的子串尽可能地长</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;[\d]{2,3}?rr&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;\%\%\£\£[0-9]{2,3}?&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;masterxiao master xxx&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;\smaster\s&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">def</span><span class="token plain"> </span><span class="token function">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token plain">pattern</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    temp</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token plain">pattern</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">temp</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;masterxiao master xxx master abc&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#\B是\b的取反。\b可以匹配长度为0的字符串</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#\B匹配长度不为0的字符串</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;\Bmaster\B&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;\bmaster\b&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;master&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;master\b&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;masterxiaotmaster xxx master abc&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;\bmaster\b&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;master\b&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;\Bmaster&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">search</span><span class="token punctuation">(</span><span class="token string">r&#x27;\Bmaster&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># ^词   表示以这个词开头</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 词$   表示以这个词结尾</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;this code in python&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;^python&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;python$&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;this is python 3&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;python$&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;this is python&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;python&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">#特殊字符 . 可以匹配任何字符</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;this is my test%&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;test.&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#可选字符 ？ 可以存在或者不存在</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;this is test tet&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;tes?t&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">#{n}表示重复n次，可以是一个区间。采用的是贪婪匹配模式</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;find all m&amp;$#&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\w]{2,3}&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#使用？可以避免使用贪婪匹配模式，但是往往结果只能匹配成最短的字串</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;find all m&amp;$#&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\w]{2,3}?&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#使用+表示重复1至多个特定的字符 （速写）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;find all m&amp;$#&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\w]+&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#使用*表示重复0至多个特定的字符 （速写）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;find all m#@#&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\w]*&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">text</span><span class="token operator">=</span><span class="token string">&#x27;汪峰唱了：《我要怒放的生命》。真的非常好听，尽管他经常破音。小李说，我不同意，王菲的《人间》更好听，还不破音。王小小说，你这都比不过迪玛希，他的高音无人能敌，一首《SOS》响彻天际。&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">text</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">text</span><span class="token punctuation">,</span><span class="token string">r&#x27;《(.+?)》&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">text</span><span class="token operator">=</span><span class="token string">&#x27;+++{}...[]&#x27;</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> random</span></div><div class="token-line"><span class="token plain">ls</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#x27;sfsf&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;fufo23@#&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;2432fSDF@#$服务&#x27;</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">new_string</span><span class="token operator">=</span><span class="token plain">text</span><span class="token operator">+</span><span class="token plain">random</span><span class="token punctuation">.</span><span class="token plain">choice</span><span class="token punctuation">(</span><span class="token plain">ls</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">new_string</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">new_string</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\+]&#x27;</span><span class="token punctuation">)</span></div></pre></div><p>例题 1：使用正则表达式解析 IP 地址。Ip 地址往往都是(1-255).(0-255).(0-255).(0-255)的格式。</p><p>a=&#x27;sdf fjiwer jweiclc swf172A131.0.123sdfsdf2sfsidfi@#<span class="math math-inline"><mjx-container className="MathJax" jax="SVG"><svg style="vertical-align:-0.452ex" xmlns="http://www.w3.org/2000/svg" width="2.715ex" height="2.149ex" role="img" focusable="false" viewBox="0 -750 1200 950" xmlns:xlink="http://www.w3.org/1999/xlink"><defs></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="merror" data-mjx-error="You can&#x27;t use &#x27;macro parameter character #&#x27; in math mode" title="You can&#x27;t use &#x27;macro parameter character #&#x27; in math mode"><rect data-background="true" width="1200" height="950" y="-200"></rect><title>You can&#x27;t use &#x27;macro parameter character #&#x27; in math mode</title><g data-mml-node="mtext" style="font-family:serif"><text data-variant="-explicitFont" transform="scale(1,-1)" font-size="884px">@#</text></g></g></g></g></svg></mjx-container></span><a href="/python/mailto:WEF@178.131.12.123">WEF@178.131.12.123</a>#@$FWFSD&#x27;</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;sdf fjiwer jweiclc swf172.131.0.123sdfsdf2sfsidfi@#$@#$WEF@178.131.12.123#@$FWFSD&#x27;</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\d]{1,3}.[\d]{1,3}.[\d]{1,3}.[\d]{1,3}&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token string">&#x27;sdf fjiwer jweiclc swf172.131.0.123sdfsdf2sfsidfi@#$@#$WEF@178.131.12.123#@$FWFSD&#x27;</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}&#x27;</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;sdf fjiwer jweiclc swf172.131.0.123sdfsdf2s&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">a</span><span class="token punctuation">,</span><span class="token string">r&#x27;[\d]{3}\.[\d]{3}\.[\d]{0,3}\.[\d]{3}&#x27;</span><span class="token punctuation">)</span></div></pre></div><p>例题 2：使用正则表达式提取电话号码。 非金属粉红色的哦覅我和哦￥%DSFSF2138675509kjshlfj khs 就十分喀麦隆 (213)8675509 分数马克思，马上。 @#￥@#！3 213.867.5509 你就安分，啊是的 iwe ￥……#￥%#@发 (213)-867-5509 发顺丰鸟看计划九十六来看 9234 鹅 1(213)867-5509 十分将人吗 +1-213-867-5509 发十分将破佳木斯普适</p><p>假如电话号码有以下几种形式： (213)8675509 213.867.5509 (213)-867-5509 1(213)867-5509 +1-213-867-5509， 把电话号码从文本里提取出来</p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">text</span><span class="token operator">=</span><span class="token string">&#x27;非金属粉红色的哦覅我和哦￥%DSFSF2138675509kjshlfj khs 就十分喀麦隆(213)8675509分数马克思，马上。 @#￥@#！3  213.867.5509你就安分，啊是的iwe ￥……#￥%#@发(213)-867-5509 发顺丰鸟看计划九十六来看9234鹅1(213)867-5509   十分将人吗  +1-213-867-5509发十分将破佳木斯普适&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">text</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">pattern</span><span class="token operator">=</span><span class="token string">r&#x27;[+]?[\d]?[-]?[(]?[\d]{3}[)]?[.-]?[\d]{3}[.-]?[\d]{4}&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">t</span><span class="token punctuation">(</span><span class="token plain">text</span><span class="token punctuation">,</span><span class="token plain">pattern</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">pattern</span><span class="token operator">=</span><span class="token string">r&#x27;\+?1?[-.]?(\(?[\d]{3}\)?)[-.]?([\d]{3})[-.]?([\d]{4})&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">pattern2</span><span class="token operator">=</span><span class="token string">r&#x27;(\+?1?)[-.]?(\(?[\d]{3}\)?)[-.]?([\d]{3})[-.]?([\d]{4})&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">pattern3</span><span class="token operator">=</span><span class="token string">r&#x27;\+?1?[-.]?\(?([\d]{3})\)?[-.]?([\d]{3})[-.]?([\d]{4})&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">ls</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#x27;2138675509&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token string">&#x27;(213)8675509&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token string">&#x27;213.867.5509&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token string">&#x27;(213)-867-5509&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token string">&#x27;1(213)867-5509&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token string">&#x27;+1-213-867-5509&#x27;</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">for</span><span class="token plain"> i </span><span class="token keyword">in</span><span class="token plain"> ls</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    t</span><span class="token punctuation">(</span><span class="token plain">i</span><span class="token punctuation">,</span><span class="token plain">pattern</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">for</span><span class="token plain"> i </span><span class="token keyword">in</span><span class="token plain"> ls</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    t</span><span class="token punctuation">(</span><span class="token plain">i</span><span class="token punctuation">,</span><span class="token plain">pattern2</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">for</span><span class="token plain"> i </span><span class="token keyword">in</span><span class="token plain"> ls</span><span class="token punctuation">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    t</span><span class="token punctuation">(</span><span class="token plain">i</span><span class="token punctuation">,</span><span class="token plain">pattern3</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">ls</span><span class="token operator">=</span><span class="token string">&#x27;2138675509￥%￥#FsF@#fsdf(213)8675509fsfsdf23$@213.867.5509fksuus#@(213)-867-5509sdfkaiis#@#^fsffs1(213)867-5509$#Fdfqf+1-213-867-5509&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">ls</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;&lt;汪涵&gt;唱了&lt;怒放的生命&gt;&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">search</span><span class="token punctuation">(</span><span class="token string">r&#x27;&lt;(.*?)&gt;.*&lt;(.*?)&gt;&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">.</span><span class="token plain">group</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">.</span><span class="token plain">group</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;\+?1?[-.]?\(?[\d]{3}\)?[-.]?[\d]{3}[-.]?[\d]{4}&#x27;</span><span class="token punctuation">,</span><span class="token string">&#x27;2138675509￥%￥#FsF@#fsdf(213)8675509fsfsdf23$@213.867.5509fksuus#@(213)-867-5509sdfkaiis#@#^fsffs1(213)867-5509$#Fdfqf+1-213-867-5509&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token plain">b</span><span class="token punctuation">)</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 第一步，找共性：       213 某些符号 867 某些符号 5509   r&#x27;\+?1?[-]?\(?[\d]{3}\)?[-.]?[\d]{3}[-.]?[\d]{4}&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 第二步  找不同      有的前面有1/+1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#问题 ：什么时候需要加\转义？    就是当这些符号本身就作为正则表达式的特殊符号的时候</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token string">r&#x27;\+?1?[-.]?\(?[\d]{3}\)?[-.]?[\d]{3}[-.]?[\d]{4}&#x27;</span></div></pre></div><p><strong>回到问题本身：如何抓取豆瓣 250 中的制片国家/地区以及语言。</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-python"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">a</span><span class="token operator">=</span><span class="token string">&#x27;&lt;span class=&quot;pl&quot;&gt;制片国家/地区:&lt;/span&gt; 美国&lt;br&gt;&lt;span class=&quot;pl&quot;&gt;语言:&lt;/span&gt; 英语&lt;br&gt;&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#b=re.search(r&#x27;(&lt;/span&gt;)(.+)(&lt;br&gt;)&#x27;,a)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span><span class="token operator">=</span><span class="token plain">re</span><span class="token punctuation">.</span><span class="token plain">findall</span><span class="token punctuation">(</span><span class="token string">r&#x27;&lt;/span&gt;(\s.*?)&lt;br&gt;&#x27;</span><span class="token punctuation">,</span><span class="token plain">a</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">b</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#for i in b:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#    c=re.search(r&#x27;(&lt;/span&gt;)(.*)(&lt;br&gt;)&#x27;,i)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#    print(c.group(2))</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#b.group(2).replace(&#x27; &#x27;,&#x27;&#x27;)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#t(a,r&#x27;(&lt;/span&gt;)(.*?)(&lt;br&gt;)&#x27;)</span></div></pre></div><style>
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}
</style></div><div class="__dumi-default-layout-footer-meta"><span data-updated-text="Last update: ">8/30/2021 02:10:09</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.js"></script>
  </body>
</html>
